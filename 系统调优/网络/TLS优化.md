## 加密算法

首先AES，AES每128个字节为一组进行加密

CBC分组模式需要的等待前面的组加密完才能进行加密，所以会选择并行计算的分组模式GCM

如果能支持AES-NI指令集，则能更搞笑地使用AES加密；否则可以选用CHACHA20

## 秘钥协商

传统的RSA加密，不具有前向保密性

DH可解决前向保密问题，其中ECDH在DH的基础上，具有更好的性能

两端各自生成随机数作为私钥，根据公开的算法加密生成公钥，通过握手发送给对方。接收到对方的公钥后，结合自己的私钥，经过计算，两端可生成同样的数字作为之后通讯的秘钥

## 提升握手性能

可以用持久连接或session id的方式，但没有前向保密性且应对重放攻击困难

使用TLS1.3可将2个RTT降为1个

TLS1.2中需要先hello交换选出加密算法，然后再交换公钥并计算生成最终的秘钥

TLS1.3合并了这两步，因为TLS1.3支持的秘钥协商算法大幅减少了，所以可以先生成常用DH算法的公钥


