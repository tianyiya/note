# 一、事件如何产生

事件分为读、写事件

UDP每次都到一个报文，则产生一个时间，进而触发回调函数执行

TCP建立连接时，当客户端收到服务端的ACK之后，会产生写事件，表示可以进行写；当服务端收到客户端的ACK时，会产生读事件，表示可以进行读

TCP建立连接后，每收到对方消息，则产生读事件；每收到对方ACK，则表示数据已经被接受，可以清除写缓冲区的一些数据，此时产生写事件，表示可写

TCP断开连接时，被动方收到FIN报文后，内核自动回复ACK报文，同时产生读事件，提醒被动方调用CLOSE关闭连接

# 二、epoll

## 数据结构

核心是eventpoll结构体，内含等待队列，就绪队列及监听事件队列

## 优势

无文件句柄限制

epoll_ctl添加感兴趣的事件，每次epoll_wait不需要重新传递socket

进程仅需要阻塞到eventpoll的阻塞队列，事件到来时也仅需要移动到就绪队列

就绪的socket可放入就绪队列，这样就不用遍历查看哪个socket就绪




