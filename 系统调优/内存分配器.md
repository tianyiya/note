# 一、各内存分配器

## ptmalloc

默认内存池

子线程预分配64MB，最多6400MB，可使用MALLOC_ARENA_MAX限制内存池的最大内存

擅长大内存分配（>256kb）,但在多线程条件下表现不好

修改默认的内存池：

`LD_PRELOAD`

## tcmalloc

大内存分配不如ptmalloc，但擅长多线程

高效的多线程分配器：TCMalloc可以在多个线程之间共享一个全局的内存池，从而减少锁竞争和内存碎片，提高了多线程环境下的分配性能。
低延迟：TCMalloc采用的是内存缓存池技术，可以在分配和回收内存时减少系统调用，从而减少延迟。
低内存碎片：TCMalloc采用类似于slab分配器的技术，可以减少内存碎片，提高内存利用率。

## jemalloc

可定制性：jemalloc提供了很多可定制的选项，可以根据实际情况进行调整，从而提高性能和内存利用率。
低内存碎片：jemalloc采用了多种技术来减少内存碎片，包括分配器缓存、自动迁移、精细化的内存回收等。
低锁竞争：jemalloc采用了多种锁机制，包括读写锁、自旋锁等，从而减少锁竞争和延迟。
综上所述，选择TCMalloc还是jemalloc取决于具体的应用场景和需求。一般来说，如果应用需要高效的多线程分配器和低延迟，可以选择TCMalloc；如果需要可定制性、低内存碎片和低锁竞争，可以选择jemalloc。在实际应用中，可以进行性能测试和评估，选择最适合的内存分配器。



